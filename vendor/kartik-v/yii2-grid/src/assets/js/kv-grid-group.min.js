/*!
 * @package   yii2-grid
 * @author    Kartik Visweswaran <kartikv2@gmail.com>
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014 - 2018
 * @version   3.2.7
 *
 * Grid grouping jquery library created for yii2-grid.
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2018, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */
var kvGridGroup;!function(t){"use strict";kvGridGroup=function(a){var r,e,n,o,d,i,s,u,c,f,l,g,h,p,v,m,k,y,w,q,x,C,b;for(r=t("#"+a),e={},n=[],s=0,u=r.find("tr.kv-page-summary"),c=r.find("tr[data-key]:first"),f=r.find("tr[data-key]:last"),l=function(t){return null==t||0===t.length},g=function(t,a,r,e,n){var o="\\d(?=(\\d{"+(n||3)+"})+"+(a>0?"\\D":"$")+")",d=parseFloat(t),i=parseInt(a);return isNaN(d)?"":(r=r||".",e=e||",",-1===(d+"").indexOf(".")&&i>0&&(d=parseFloat(d+".0")),d.toFixed(isNaN(i)||i<0?0:i).replace(".",r).replace(new RegExp(o,"g"),"$&"+e))},h=function(t){var a,r,e,n,o=t.attr("data-sub-group-of");if(l(o))return null;if(n='td[data-col-seq="'+o+'"]',(e=(r=(a=t.closest("tr")).find(n)).length)>0)return r;for(;0===e&&a.length;)e=(r=(a=a.prev()).find(n)).length;return 0===e?null:r},p=function(t,a){var r=t.attr("data-group-key"),e=0,n=a;if(a.attr("data-last-row"))return a;for(;0===e&&n.length;)n=a,e=(a=a.next()).find('td[data-group-key="'+r+'"]').length;return n.length?n:f},v=function(t,a,r){var e;return t&&t.length?(t.is("[data-raw-value]")?e=t.attr("data-raw-value"):(e=t.text().split(r||",").join(""),a&&"."!==a&&(e=e.replace(a,"."))),e?parseFloat(e):0):0},m=function(a,r,e,n,o){var d=1,i=[],s=a,u=s.hasClass("kv-grid-group-row"),c=r.attr("rowspan")||1;if(u)for(d=!1,s=s.next(":not(.kv-grid-group-row)");!d&&s.length;)s.find('td[data-col-seq="'+e+'"]').each(function(){i.push(v(t(this),n,o))}),d=s.hasClass("kv-grid-group-row"),s=s.next();else for(;d<=c&&s.length;)s.find('td[data-col-seq="'+e+'"]').each(function(){i.push(v(t(this),n,o))}),s=s.next(),d++;return i},k=function(t,a,r,e,n){var o=n.format||"",d=n.func?window[n.func]:"",i=n.decPoint||".",s=n.thousandSep||",",u="number"===o||"callback"===o&&"function"==typeof d?m(a,r,e,i,s):t;return C(t,u,n)},C=function(t,a,r){var e,n=r.decimals||0,o=r.decPoint||".",d=r.thousandSep||",",i=r.format||"",s=r.func?window[r.func]:"";return"number"===i?(e=b(a,t),g(e,n,o,d)):"callback"===i&&"function"==typeof s?s(a):t},b=function(t,a){var r,e=0,n=t&&t.length||0;if(!n)return"";switch(a){case"f_count":return n;case"f_sum":case"f_avg":for(r=0;r<n;r++)e+=t[r];return"f_sum"===a?e:e/n;case"f_max":case"f_min":return Math["f_max"===a?"max":"min"].apply(null,t);default:return""}},y=function(t,a){a=a||1;var r=t.attr("rowspan")||1;r=parseInt(r)+a,t.attr("rowspan",r)},w=function(){var a,r=[];if(f.nextAll("tr.kv-group-footer").each(function(){r.push(t(this))}),r.length)for(a=0;a<r.length;a++)f.after(r[a]);u.length&&u.find("td").each(function(){var a=t(this);c.find('td[data-col-seq="'+a.attr("data-col-seq")+'"]').length||a.remove()})},q=function(){var a,e=n.length,o=r.find("tbody:first"),d=o.find("tr.kv-group-footer").length;e<3||!d||(o.find(" > tr[data-group-key]").each(function(){var a=t(this);a.find("td.kv-grid-group").each(function(){var r=t(this),e=r.attr("data-sub-group-of")||"0",n=0,o=!0;a.nextAll().each(function(){o&&(n++,t(this).attr("data-group-seq")===e&&(o=!1))}),r.attr("rowspan",n)})}),o.find(" > tr.kv-group-footer").each(function(){var r=t(this),e=parseInt(r.attr("data-group-seq")||0);for(a=1;a<=e;a++)r.find("td[data-summary-col-seq="+a+"]").remove()}),o.find(" > tr.kv-group-footer > td").each(function(){var a,r,e,n,o,d=t(this),i=d.data("groupSummary")||null,s=[],u=!0;i&&((a=i.config).format||a.func)&&(r=d.attr("data-summary-col-seq"),n=d.closest("tr"),e=n.attr("data-group-seq"),n.prevAll().each(function(){var n,o=t(this),d=o.attr("data-group-seq")||"-1";u&&(n=v(o.find("td[data-col-seq="+r+"]"),a.decPoint,a.thousandSep),s.push(n),d===e&&(u=!1))}),o=C(i.source||"",s,a),d.html(o))}))},x=function(a,r){var e,o,d,i,s,u,f,l,g,v,m,w,q=a.data(r),x="groupHeader"===r?"kv-group-header":"kv-group-footer";q&&(o=a.attr("data-group-key"),d=a.closest("tr"),o&&d.attr("data-group-key",o),e=a.attr("data-sub-group-of")?h(a):null,w=e&&e.length&&e.is("[data-grouped-row]"),o=e&&e.length?e.attr("data-col-seq"):null,f=t(document.createElement("tr")),q.options&&f.attr(q.options),f.addClass(x).attr({"data-group-seq":o||"0"}),c.find("td").each(function(){var r;i=t(this),s=i.attr("data-col-seq"),o&&s===o&&!w||(l=t(document.createElement("td")).attr("data-summary-col-seq",s),q.content&&q.content[s]&&(m=q.contentFormats&&q.contentFormats[s]||{},v=k(q.content[s],d,a,s,m),r={source:q.content[s],config:m},l.html(v).data("groupSummary",r)),q.contentOptions&&q.contentOptions[s]&&l.attr(q.contentOptions[s]),i.hasClass("kv-grid-hide")&&l.addClass("kv-grid-hide"),i.hasClass("skip-export")&&l.addClass("skip-export"),l.appendTo(f))}),e&&e.length&&!w&&n.length<3&&y(e),"groupHeader"===r?(d.before(f),d.find('td[data-col-seq="'+o+'"]').length&&f.find("td").each(function(){var a=t(this),r=parseInt(a.attr("data-summary-col-seq"));r!==(o=parseInt(o))-1?r!==o+1?r>o&&a.before(e):a.before(e):a.after(e)})):(g=p(a,d),w&&g.hasClass("kv-grid-group-row")?g.before(f):g.after(f)),q.mergeColumns&&q.mergeColumns.length&&t.each(q.mergeColumns,function(a,r){var e=r[0],n=r[1],o=0,d="";e>-1&&n>-1&&(f.find("td").each(function(){var a=t(this);(u=a.attr("data-summary-col-seq"))>=e&&u<=n&&(d+=a.html(),o++)}),f.find("td").each(function(){var a=t(this);(u=parseInt(a.attr("data-summary-col-seq")||-1))>e&&u<=n?a.remove():u===e&&a.attr("colspan",o).html(d)}))}))},function(){var a=0;u.length&&u.find("td").each(function(){t(this).attr("data-col-seq",a),a++})}(),r.find("td.kv-grid-group").each(function(){var a=t(this),r=t(this).attr("data-group-key");r&&(t.inArray(r,n)<0&&n.push(r),void 0===e[r]?e[r]=[a]:e[r].push(a))}),t.each(n,function(a,r){var o,d,i=e[r],s=1,u=0,c="",f="",l="",g="";t.each(i,function(t,r){c=r.text().trim(),o=i[u],a>0?((d=h(r))&&d.length&&(f=d.attr("data-cell-key")),g=f?f+"-"+c:c):g=c,r.attr("data-cell-key",g),g===l?(s++,n.length<3&&o.attr("rowspan",s),r.addClass("kv-temp-cells").hide()):(u=t,s=1),l=g})}),r.find("td.kv-grid-group.kv-temp-cells").remove(),t.each(n,function(a,e){var n=0;r.find('td[data-group-key="'+e+'"]').each(function(){var a,r=t(this),e=n%2>0?r.attr("data-odd-css"):r.attr("data-even-css");e&&r.removeClass(e).addClass(e),r.is("[data-grouped-row]")&&(a=t(document.createElement("tr")).addClass("kv-grid-group-row"),r.closest("tr").before(a),r.removeAttr("rowspan").appendTo(a).css("width","auto")),n++})}),(o=r.find("tr.kv-grid-group-row")).length&&((s=r.find("tr[data-key]:first > td").length)&&o.each(function(){t(this).find(">td").attr("colspan",s)}),o.find("td[data-group-key]").each(function(){var a=t(this).data("groupKey"),e=r.find(".kv-grid-group-header[data-group-key]"),n=r.find(".kv-grid-group-filter[data-group-key]");t(this).closest("tr").data("groupKey",a),e.length&&r.find('.kv-grid-group-header[data-group-key="'+a+'"]').remove(),n.length&&r.find('.kv-grid-group-filter[data-group-key="'+a+'"]').remove()})),f.attr("data-last-row",1),d=i=n.length-1;d>=0;d--)r.find('td[data-group-key="'+n[d]+'"]').each(function(){x(t(this),"groupFooter")});for(d=0;d<=i;d++)r.find('td[data-group-key="'+n[d]+'"]').each(function(){x(t(this),"groupHeader")});w(),q()}}(window.jQuery);